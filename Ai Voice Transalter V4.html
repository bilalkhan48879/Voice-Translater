<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Translator</title>
    <style>
        body {
            background-image: url("./speak.jpg");
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            background-attachment: fixed;
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        .container {
            display: inline-block;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        button {
            display: inline-block;
            padding: 10px 20px;
            margin-bottom: 20px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            color: #fff;
            background-color: #9C27B0;
            border: none;
            border-radius: 5px;
            box-shadow: 0px 0px 10px #9C27B0;
            transition: all 0.3s ease-in-out;
        }
        button:hover {
            color: #9C27B0;
            background-color: #fff;
            box-shadow: 0px 0px 10px #9C27B0, 0px 0px 40px #9C27B0;
        }
        p {
            font-size: 18px;
            margin: 10px 0;
        }
        #Writing {
            border-radius: 1em;
            background-image: url("./123.jpg");
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            background-attachment: fixed;
            color: rgb(7, 7, 7);
            font-size: 45px;
            font-family: 'Times New Roman', Times, serif;
            font-weight: 100;
            font-style: italic;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        #voice-lines, #voice-lines_2 {
            background-color: #fff;
            color: #000;
            font-size: 24px;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }
        .line, .line_2 {
            width: 5px;
            height: 50px;
            background-color: #000;
            margin: 0 5px;
            display: inline-block;
            animation: bounce 1s infinite;
        }
        .line_2 {
            background-color: #f10797;
        }
        .line:nth-child(2), .line_2:nth-child(2) {
            animation-delay: 0.1s;
        }
        .line:nth-child(3), .line_2:nth-child(3) {
            animation-delay: 0.2s;
        }
        .line:nth-child(4), .line_2:nth-child(4) {
            animation-delay: 0.3s;
        }
        .line:nth-child(5), .line_2:nth-child(5) {
            animation-delay: 0.4s;
        }
        @keyframes bounce {
            0%, 100% {
                transform: scaleY(1);
            }
            50% {
                transform: scaleY(0.5);
            }
        }
        .voice-container {
            display: none;
            margin-top: 20px;
            border: 2px solid hotpink;
            border-radius: 10px;
            box-shadow: 0px 0px 10px #9C27B0, 0px 0px 20px hotpink;
            padding: 20px;
            background-color: #f3e5f5;
            position: relative;
        }
        .result-container {
            display: none;
            margin-top: 20px;
            border: 2px solid black;
            border-radius: 10px;
            box-shadow: 0px 0px 10px #9C27B0, 0px 0px 20px black;
            padding: 20px;
            background-color: #f3e5f5;
            position: relative;
        }
        .icons {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .speaker-icon, .copy-icon {
            cursor: pointer;
            margin-left: 10px;
            color: blue;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div id="voice-lines">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>
    <div id="voice-lines_2">
        <div class="line_2"></div>
        <div class="line_2"></div>
        <div class="line_2"></div>
        <div class="line_2"></div>
        <div class="line_2"></div>
    </div>
    <div class="container">
        <marquee behavior="float" scrollamount="5" direction="left">
            <h2 style=" color:green; border-radius: 5px;">The AI Voice Translator Version 4.0</h2>
        </marquee>
        <marquee behavior="float" scrollamount="5" direction="left">
            <h2 style=" color:green; border-radius: 5px;">Launch Date:- |05-08-2024| On |Monday|</h2>
        </marquee>
        <marquee behavior="float" direction="left">
            <h1>AI Voice Translator By Muhammad Bilal Azhar Khan</h1>
        </marquee>
        <button onclick="startRecognition('Urdu_English');" id="start-recognition-urdu-english">Urdu To English</button>
        <button onclick="startRecognition('Urdu_Arabic');" id="start-recognition-urdu-arabic">Urdu To Arabic</button>
        <button onclick="startRecognition('Urdu_Pashto');" id="start-recognition-urdu-pashto">Urdu To Pashto</button>
        <div id="Writing">
            <div class="voice-container" id="result-container-urdu">
                <p id="result-urdu"></p>
            </div>
            <div class="result-container" id="result-container-english">
                <div class="icons">
                    <span class="speaker-icon" id="speaker-icon-english">&#128264;</span>
                    <span class="copy-icon" id="copy-icon-english">&#128203;</span>
                </div>
                <p id="result-english"></p>
            </div>
            <div class="result-container" id="result-container-arabic">
                <div class="icons">
                    <span class="speaker-icon" id="speaker-icon-arabic">&#128264;</span>
                    <span class="copy-icon" id="copy-icon-arabic">&#128203;</span>
                </div>
                <p id="result-arabic"></p>
            </div>
            <div class="result-container" id="result-container-pashto">
                <div class="icons">
                    <span class="speaker-icon" id="speaker-icon-pashto">&#128264;</span>
                    <span class="copy-icon" id="copy-icon-pashto">&#128203;</span>
                </div>
                <p id="result-pashto"></p>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
    // Function to request permissions
    function requestPermissions() {
        if (navigator.permissions) {
            // Request permission for microphone access
            navigator.permissions.query({name: 'microphone'}).then(function(permissionStatus) {
                if (permissionStatus.state === 'denied') {
                    alert('Microphone permission is required for voice recognition.');
                }
            });

            // Request permission for audio playback (if needed)
            navigator.permissions.query({name: 'audio-playback'}).then(function(permissionStatus) {
                if (permissionStatus.state === 'denied') {
                    alert('Audio playback permission is required for speech synthesis.');
                }
            });
        } else {
            console.warn('Permissions API not supported in this browser.');
        }
    }

    // Function to handle speech synthesis
    function speakText(text, lang) {
        if ('speechSynthesis' in window) {
            showVoiceLines();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;

            utterance.onend = function() {
                hideVoiceLines();
            };

            speechSynthesis.speak(utterance);
        } else {
            console.error('Speech Synthesis API not supported.');
        }
    }

    function showVoiceLines() {
        document.getElementById('voice-lines').style.display = 'block';
    }

    function hideVoiceLines() {
        document.getElementById('voice-lines').style.display = 'none';
    }

    function showVoiceLines_2() {
        document.getElementById('voice-lines_2').style.display = 'block';
    }

    function hideVoiceLines_2() {
        document.getElementById('voice-lines_2').style.display = 'none';
    }

    function addSpeakerIcon(textElementId, text, lang) {
        const speakerIcon = document.getElementById('speaker-icon-' + textElementId);
        speakerIcon.onclick = function() {
            speakText(text, lang);
            document.getElementById('result-container-' + textElementId).style.display = 'block';
        };
    }

    function addCopyIcon(textElementId, text) {
        const copyIcon = document.getElementById('copy-icon-' + textElementId);
        copyIcon.onclick = function() {
            navigator.clipboard.writeText(text).then(() => {
                alert('Text copied to clipboard');
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        };
    }

    function Urdu_English() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'ur-PK';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.onstart = function() {
            showVoiceLines_2();
            hideAllResultContainers();
        };

        recognition.onend = function() {
            hideVoiceLines_2();
        };

        recognition.start();

        recognition.onresult = function(event) {
            const urduText = event.results[0][0].transcript;
            document.getElementById('result-urdu').textContent = 'Urdu: ' + urduText;
            document.getElementById('result-container-urdu').style.display = 'block';
            translateText(urduText, 'en', 'english', 'en-US');
        };

        recognition.onerror = function(event) {
            console.error('Error occurred in recognition: ' + event.error);
        };
    }

    function Urdu_Arabic() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'ur-PK';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.onstart = function() {
            showVoiceLines_2();
            hideAllResultContainers();
        };

        recognition.onend = function() {
            hideVoiceLines_2();
        };

        recognition.start();

        recognition.onresult = function(event) {
            const urduText = event.results[0][0].transcript;
            document.getElementById('result-urdu').textContent = 'Urdu: ' + urduText;
            document.getElementById('result-container-urdu').style.display = 'block';
            translateText(urduText, 'ar', 'arabic', 'ar-SA');
        };

        recognition.onerror = function(event) {
            console.error('Error occurred in recognition: ' + event.error);
        };
    }

    function Urdu_Pashto() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'ur-PK';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.onstart = function() {
            showVoiceLines_2();
            hideAllResultContainers();
        };

        recognition.onend = function() {
            hideVoiceLines_2();
        };

        recognition.start();

        recognition.onresult = function(event) {
            const urduText = event.results[0][0].transcript;
            document.getElementById('result-urdu').textContent = 'Urdu: ' + urduText;
            document.getElementById('result-container-urdu').style.display = 'block';
            translateText(urduText, 'ps', 'pashto', 'ps-PK');
        };

        recognition.onerror = function(event) {
            console.error('Error occurred in recognition: ' + event.error);
        };
    }

    function translateText(text, targetLang, textElementId, speakLang) {
        const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=ur&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const translatedText = data[0][0][0];
                const resultElement = document.getElementById('result-' + textElementId);
                resultElement.textContent = targetLang.charAt(0).toUpperCase() + targetLang.slice(1) + ': ' + translatedText;
                document.getElementById('result-container-' + textElementId).style.display = 'block';
                addSpeakerIcon(textElementId, translatedText, speakLang);
                addCopyIcon(textElementId, translatedText);
                speakText(translatedText, speakLang);
            })
            .catch(error => {
                console.error('Error occurred while translating: ', error);
            });
    }

    function hideAllResultContainers() {
        const resultContainers = document.getElementsByClassName('result-container');
        for (let i = 0; i < resultContainers.length; i++) {
            resultContainers[i].style.display = 'none';
        }
    }

    function startRecognition(translationFunction) {
        requestPermissions();  // Ensure permissions are requested before starting recognition
        window[translationFunction]();
    }

    // Bind startRecognition to buttons
    document.getElementById('start-recognition-urdu-english').onclick = function() {
        startRecognition('Urdu_English');
    };

    document.getElementById('start-recognition-urdu-arabic').onclick = function() {
        startRecognition('Urdu_Arabic');
    };

    document.getElementById('start-recognition-urdu-pashto').onclick = function() {
        startRecognition('Urdu_Pashto');
    };
});

    </script>
</body>
</html>
